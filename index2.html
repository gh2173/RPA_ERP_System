<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ë§¤ì…ì†¡ì¥ ì²˜ë¦¬ - ERP RPA ëŒ€ì‹œë³´ë“œ</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-image: url('https://www.transparenttextures.com/patterns/paper-fibers.png');
      background-color: #f9fcff;
      padding: 40px;
      color: #2c3e50;
      transition: background-color 0.3s ease;
      margin: 0;
    }
    .container {
      max-width: 1440px;
      margin: auto;
    }
    .section {
      margin-bottom: 30px;
      padding: 24px;
      background: #ffffff;
      border-radius: 16px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.08);
      transition: box-shadow 0.2s ease-in-out, transform 0.2s;
    }
    .section:hover {
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12);
      transform: translateY(-2px);
    }
    .input-group {
      margin-top: 20px;
      padding: 15px;
      border: 1px solid #ddd;
      border-radius: 5px;
      background-color: #f9f9f9;
    }
    .input-group h3 {
      margin-top: 0;
      margin-bottom: 15px;
      color: #333;
    }
    .form-row {
      display: flex;
      align-items: center;
      gap: 15px;
      margin-bottom: 15px;
      flex-wrap: wrap;
    }
    .form-row label {
      min-width: 120px;
      font-weight: bold;
      color: #333;
    }
    .form-row input, .form-row select {
      padding: 8px 12px;
      border: 1px solid #ccc;
      border-radius: 4px;
      min-width: 200px;
    }
    .form-row input:focus, .form-row select:focus {
      border-color: #2980b9;
      outline: none;
      box-shadow: 0 0 5px rgba(41, 128, 185, 0.4);
    }
    .button-group {
      margin-top: 20px;
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }
    .button-group button {
      padding: 10px 20px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
      transition: all 0.3s ease;
    }
    .btn-primary {
      background-color: #2980b9;
      color: white;
    }
    .btn-primary:hover {
      background-color: #1c6692;
    }
    .btn-success {
      background-color: #27ae60;
      color: white;
    }
    .btn-success:hover {
      background-color: #1e8449;
    }
    .btn-secondary {
      background-color: #7f8c8d;
      color: white;
    }
    .btn-secondary:hover {
      background-color: #5d6d6e;
    }
    .file-list {
      margin-top: 20px;
    }
    .file-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 15px;
      border: 1px solid #e0e0e0;
      border-radius: 6px;
      margin-bottom: 8px;
      background: white;
    }
    .file-info {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .file-icon {
      font-size: 20px;
    }
    .file-name {
      font-weight: 500;
    }
    .file-size {
      color: #666;
      font-size: 12px;
    }
    .file-actions {
      display: flex;
      gap: 8px;
    }
    .file-actions button {
      padding: 4px 8px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 12px;
    }
    .btn-remove {
      background-color: #e74c3c;
      color: white;
    }
    .btn-remove:hover {
      background-color: #c0392b;
    }
    .status-indicator {
      padding: 4px 8px;
      border-radius: 12px;
      font-size: 11px;
      font-weight: bold;
    }
    .status-pending {
      background: #f39c12;
      color: white;
    }
    .status-processing {
      background: #3498db;
      color: white;
    }
    .status-completed {
      background: #27ae60;
      color: white;
    }
    .status-error {
      background: #e74c3c;
      color: white;
    }
    .progress-section {
      margin-top: 30px;
    }
    .progress-bar {
      width: 100%;
      height: 8px;
      background-color: #ecf0f1;
      border-radius: 4px;
      overflow: hidden;
      margin-top: 10px;
    }
    .progress-fill {
      height: 100%;
      background-color: #2980b9;
      width: 0%;
      transition: width 0.3s ease;
    }
    .progress-text {
      margin-top: 10px;
      font-size: 14px;
      color: #666;
    }

    /* ì‚¬ì´ë“œë°” ë„¤ë¹„ê²Œì´ì…˜ ìŠ¤íƒ€ì¼ */
    .sidebar {
      position: fixed;
      left: 0;
      top: 0;
      width: 250px;
      height: 100vh;
      background: #ffffff;
      box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
      z-index: 999;
      padding: 20px 0;
      transition: all 0.3s ease;
    }    .sidebar-header {
      padding: 0 20px 30px;
      border-bottom: 1px solid #e0e0e0;
      margin-bottom: 30px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }    .sidebar-logo {
      width: 99.45%;
      aspect-ratio: 1;
      margin-bottom: 15px;
      border-radius: 12px;
      object-fit: cover;
    }    .sidebar-title {
      font-size: 18px;
      font-weight: bold;
      color: #2c3e50;
      margin: 0;
    }

    .sidebar-subtitle {
      font-size: 11px;
      color: #7f8c8d;
      margin-top: 8px;
      font-weight: 400;
      text-align: center;
      opacity: 0.8;
    }

    .sidebar-nav {
      padding: 0 10px;
    }

    .nav-item {
      display: block;
      padding: 15px 20px;
      margin-bottom: 5px;
      border-radius: 8px;
      text-decoration: none;
      color: #666;
      font-weight: 500;
      transition: all 0.3s ease;
      cursor: pointer;
    }

    .nav-item:hover {
      background: #f0f5ff;
      color: #2980b9;
      text-decoration: none;
    }

    .nav-item.active {
      background: #2980b9;
      color: white;
    }

    .nav-item.active:hover {
      background: #1c6692;
    }

    .nav-icon {
      margin-right: 12px;
      font-size: 16px;
    }

    /* ë©”ì¸ ì»¨í…ì¸  ì˜ì—­ ì¡°ì • */
    .main-content {
      margin-left: 250px;
      transition: margin-left 0.3s ease;
    }    /* ìŠ¤í¬ë¦° ìº¡ì²˜ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
    .screen-capture-btn {
      position: fixed;
      top: 20px;
      right: 80px; /* ë‹¤í¬ëª¨ë“œ ë²„íŠ¼ ì™¼ìª½ì— ìœ„ì¹˜ */
      background: #27ae60;
      color: white;
      border: none;
      border-radius: 50%;
      width: 50px;
      height: 50px;
      font-size: 20px;
      cursor: pointer;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      transition: all 0.3s ease;
      z-index: 1001;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .screen-capture-btn:hover {
      background: #219a52;
      transform: scale(1.1);
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
    }

    .screen-capture-btn:active {
      transform: scale(0.95);
    }

    /* ë‹¤í¬ëª¨ë“œ í† ê¸€ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
    .dark-mode-toggle {
      position: fixed;
      top: 20px;
      right: 20px;
      background: #2980b9;
      color: white;
      border: none;
      border-radius: 50%;
      width: 50px;
      height: 50px;
      font-size: 20px;
      cursor: pointer;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      transition: all 0.3s ease;
      z-index: 1001;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .dark-mode-toggle:hover {
      background: #1c6692;
      transform: scale(1.1);
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
    }

    /* ë‹¤í¬ëª¨ë“œ ìŠ¤íƒ€ì¼ */
    body.dark-mode {
      background-color: #1a1a1a;
      background-image: none;
      color: #e0e0e0;
    }

    body.dark-mode .section {
      background: #2d2d2d;
      color: #e0e0e0;
      border: 1px solid #404040;
    }

    body.dark-mode .input-group {
      background-color: #3a3a3a;
      border: 1px solid #555;
    }

    body.dark-mode .input-group h3,
    body.dark-mode .form-row label,
    body.dark-mode h2,
    body.dark-mode h3 {
      color: #e0e0e0 !important;
    }

    body.dark-mode .form-row input,
    body.dark-mode .form-row select {
      background: #404040;
      color: #e0e0e0;
      border: 1px solid #555;
    }

    body.dark-mode .form-row input:focus,
    body.dark-mode .form-row select:focus {
      border-color: #4a9eff;
      box-shadow: 0 0 5px rgba(74, 158, 255, 0.4);
    }

    body.dark-mode .file-item {
      background: #404040;
      border-color: #555;
      color: #e0e0e0;
    }

    body.dark-mode .progress-bar {
      background-color: #404040;
    }

    body.dark-mode .progress-text {
      color: #b0b0b0;
    }

    /* ì‚¬ì´ë“œë°” ë‹¤í¬ëª¨ë“œ ìŠ¤íƒ€ì¼ */
    body.dark-mode .sidebar {
      background: #2d2d2d;
      box-shadow: 2px 0 10px rgba(0, 0, 0, 0.3);
    }

    body.dark-mode .sidebar-header {
      border-bottom: 1px solid #404040;
    }    body.dark-mode .sidebar-title {
      color: #e0e0e0;
    }

    body.dark-mode .sidebar-subtitle {
      color: #95a5a6;
    }

    body.dark-mode .nav-item {
      color: #b0b0b0;
    }

    body.dark-mode .nav-item:hover {
      background: #404040;
      color: #4a9eff;
    }

    body.dark-mode .nav-item.active {
      background: #4a9eff;
      color: white;
    }

    body.dark-mode .nav-item.active:hover {
      background: #357abd;
    }    body.dark-mode .dark-mode-toggle {
      background: #f39c12;
    }

    body.dark-mode .dark-mode-toggle:hover {
      background: #e67e22;
    }

    /* ë‹¤í¬ëª¨ë“œì—ì„œ ìŠ¤í¬ë¦° ìº¡ì²˜ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
    body.dark-mode .screen-capture-btn {
      background: #e67e22;
    }

    body.dark-mode .screen-capture-btn:hover {
      background: #d35400;
    }

    /* í”Œë ˆì´ìŠ¤í™€ë” í…ìŠ¤íŠ¸ ë‹¤í¬ëª¨ë“œ */
    body.dark-mode input::placeholder {
      color: #999 !important;
    }

    body.dark-mode input::-webkit-input-placeholder {
      color: #999 !important;
    }

    body.dark-mode input::-moz-placeholder {
      color: #999 !important;
    }    body.dark-mode input:-ms-input-placeholder {
      color: #999 !important;
    }

    /* ë‹¨ê³„ë³„ ì²˜ë¦¬ ìƒì„¸ ìŠ¤íƒ€ì¼ */
    .step-item {
      display: flex;
      align-items: center;
      padding: 10px 15px;
      margin-bottom: 8px;
      border: 1px solid #e0e0e0;
      border-radius: 6px;
      background: white;
      transition: all 0.3s ease;
    }

    .step-number {
      font-weight: bold;
      min-width: 60px;
      color: #2980b9;
    }

    .step-name {
      flex: 1;
      margin: 0 15px;
      color: #333;
    }

    .step-status {
      font-weight: bold;
      padding: 4px 8px;
      border-radius: 12px;
      font-size: 12px;
      white-space: nowrap;
    }

    .step-status.waiting {
      background: #f8f9fa;
      color: #6c757d;
    }

    .step-status.processing {
      background: #3498db;
      color: white;
      animation: pulse 1.5s infinite;
    }

    .step-status.completed {
      background: #27ae60;
      color: white;
    }

    .step-status.failed {
      background: #e74c3c;
      color: white;
    }

    @keyframes pulse {
      0% { opacity: 1; }
      50% { opacity: 0.7; }
      100% { opacity: 1; }
    }

    /* ë‹¤í¬ëª¨ë“œ ë‹¨ê³„ë³„ ì²˜ë¦¬ ìŠ¤íƒ€ì¼ */
    body.dark-mode .step-item {
      background: #404040;
      border-color: #555;
    }

    body.dark-mode .step-name {
      color: #e0e0e0;
    }

    body.dark-mode .step-number {
      color: #4a9eff;
    }

    body.dark-mode .step-status.waiting {
      background: #495057;
      color: #adb5bd;
    }

    /* ì„¹ì…˜ í—¤ë” ë ˆì´ì•„ì›ƒ ìŠ¤íƒ€ì¼ */
    .section-header-with-button {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 20px;
    }

    .section-header-content {
      flex: 1;
    }

    .section-header-actions {
      flex-shrink: 0;
      display: flex;
      gap: 10px;
      align-items: flex-start;
      margin-top: 5px;
    }

    /* ë‹¤ì¤‘ëª¨ë“œ ì²˜ë¦¬ ê²°ê³¼ ìŠ¤íƒ€ì¼ */
    .group-result {
      margin-bottom: 20px;
      border: 1px solid #e0e0e0;
      border-radius: 8px;
      background: #f8f9fa;
      overflow: hidden;
    }

    .group-header {
      background: #2980b9;
      color: white;
      padding: 12px 16px;
      font-weight: bold;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .group-header.success {
      background: #27ae60;
    }

    .group-header.failed {
      background: #e74c3c;
    }

    .group-header.processing {
      background: #3498db;
      animation: pulse 1.5s infinite;
    }

    .group-body {
      padding: 15px;
    }

    .group-steps {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 8px;
    }

    .group-step {
      display: flex;
      align-items: center;
      padding: 6px 10px;
      border-radius: 4px;
      background: white;
      border: 1px solid #dee2e6;
      font-size: 13px;
    }

    .group-step-number {
      font-weight: bold;
      min-width: 50px;
      color: #495057;
    }

    .group-step-name {
      flex: 1;
      margin-right: 10px;
      color: #333;
    }

    .group-step-status {
      font-weight: bold;
      padding: 2px 6px;
      border-radius: 8px;
      font-size: 11px;
      white-space: nowrap;
    }

    .group-step-status.completed {
      background: #d4edda;
      color: #155724;
    }

    .group-step-status.failed {
      background: #f8d7da;
      color: #721c24;
    }

    .group-step-status.processing {
      background: #cce7ff;
      color: #004085;
      animation: pulse 1.5s infinite;
    }

    .group-step-status.waiting {
      background: #f8f9fa;
      color: #6c757d;
    }

    /* ë‹¤í¬ëª¨ë“œ ë‹¤ì¤‘ëª¨ë“œ ì²˜ë¦¬ ê²°ê³¼ ìŠ¤íƒ€ì¼ */
    body.dark-mode .group-result {
      border-color: #555;
      background: #404040;
    }

    body.dark-mode .group-body {
      background: #404040;
    }

    body.dark-mode .group-step {
      background: #2d2d2d;
      border-color: #555;
    }

    body.dark-mode .group-step-name {
      color: #e0e0e0;
    }

    body.dark-mode .group-step-number {
      color: #adb5bd;
    }

    body.dark-mode .group-step-status.completed {
      background: #1e7e34;
      color: #d4edda;
    }

    body.dark-mode .group-step-status.failed {
      background: #c82333;
      color: #f8d7da;
    }

    body.dark-mode .group-step-status.processing {
      background: #0056b3;
      color: #cce7ff;
    }

    body.dark-mode .group-step-status.waiting {
      background: #495057;
      color: #adb5bd;
    }

    /* RPA ì‹¤í–‰ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
    .action-btn {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 12px 20px;
      border: none;
      border-radius: 6px;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .process-btn {
      background: linear-gradient(135deg, #27ae60, #2ecc71);
      color: white;
    }

    .process-btn:hover:not(:disabled) {
      background: linear-gradient(135deg, #229954, #27ae60);
      transform: translateY(-1px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.15);
    }

    .process-btn:disabled {
      background: #bdc3c7;
      cursor: not-allowed;
      transform: none;
      box-shadow: 0 1px 2px rgba(0,0,0,0.1);
    }

    .btn-icon {
      font-size: 12px;
    }

    /* ë‹¤í¬ ëª¨ë“œìš© RPA ì‹¤í–‰ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
    body.dark-mode .process-btn {
      background: linear-gradient(135deg, #1e7e34, #28a745);
    }

    body.dark-mode .process-btn:hover:not(:disabled) {
      background: linear-gradient(135deg, #155724, #1e7e34);
    }

    body.dark-mode .process-btn:disabled {
      background: #495057;
    }

    /* single-input ìŠ¤íƒ€ì¼ */
    .single-input {
      display: flex;
      align-items: center;
      gap: 15px;
      margin-bottom: 10px;
    }
    
    .single-input label {
      min-width: 120px;
      font-weight: bold;
      color: #333;
    }
    
    .single-input input {
      padding: 8px 12px;
      border: 1px solid #ccc;
      border-radius: 4px;
    }
    
    .single-input input:focus {
      border-color: #2980b9;
      outline: none;
      box-shadow: 0 0 5px rgba(41, 128, 185, 0.4);
    }
    
    /* ë‹¤í¬ëª¨ë“œì—ì„œ single-input ìŠ¤íƒ€ì¼ */
    body.dark-mode .single-input label {
      color: #e0e0e0 !important;
    }
    
    body.dark-mode .single-input input {
      background: #404040;
      color: #e0e0e0;
      border: 1px solid #555;
    }
    
    body.dark-mode .single-input input:focus {
      border-color: #4a9eff;
      box-shadow: 0 0 5px rgba(74, 158, 255, 0.4);
    }
  </style>
</head>
<body>
  <!-- ë¡œê·¸ì¸ ëª¨ë“ˆ ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ -->
  <script src="login-module.js"></script>  <!-- ì‚¬ì´ë“œë°” ë„¤ë¹„ê²Œì´ì…˜ -->  <div class="sidebar">
    <div class="sidebar-header">
      <img src="ERP_RPAì•„ì´ì½˜.png" alt="ERP RPA" class="sidebar-logo">
    <div class="sidebar-title">ERP RPA SYSTEM - Ark</div>
    <div class="sidebar-subtitle" style="font-size:12px; font-weight:400; margin-top:4px;">
      <span style="color:#2980b9; font-weight:600;">HyperAutomation</span> <span style="opacity:0.7;">| Rev. 2025.06.28</span>
    </div>
    </div>
    <nav class="sidebar-nav">
      <a href="index.html" class="nav-item" id="nav-voucher">
        <span class="nav-icon">ğŸ“‹</span>
        1. íšŒê³„ ì „í‘œ ìƒì‹ 
      </a>
      <a href="index2.html" class="nav-item active" id="nav-invoice">
        <span class="nav-icon">ğŸ“„</span>
        2. ë§¤ì…ì†¡ì¥ ìƒì‹ 
      </a>    </nav>
  </div>

  <!-- ë©”ì¸ ì»¨í…ì¸  -->
  <div class="main-content">
    <!-- ìŠ¤í¬ë¦° ìº¡ì²˜ ë²„íŠ¼ -->
    <button class="screen-capture-btn" onclick="captureFullPage()" title="ì „ì²´ í˜ì´ì§€ ìŠ¤í¬ë¦°ìƒ·">
      <span id="captureIcon">ğŸ“·</span>
    </button>
    
    <!-- ë‹¤í¬ëª¨ë“œ í† ê¸€ ë²„íŠ¼ -->
    <button class="dark-mode-toggle" onclick="toggleDarkMode()" title="ë‹¤í¬ëª¨ë“œ ì „í™˜">
      <span id="darkModeIcon">ğŸŒ™</span>
    </button>
    
    <div class="container"><!-- í˜ì´ì§€ í—¤ë” -->
      <div class="section">
        <h2>ğŸ“„ ë§¤ì…ì†¡ì¥ ì²˜ë¦¬</h2>
        <p>ë§¤ì…ì†¡ì¥ ìë™ ì²˜ë¦¬ë¥¼ ì§„í–‰í•©ë‹ˆë‹¤.</p>

        <!-- ë…„ë„&ì›” ì„ íƒ ì„¹ì…˜ -->
        <div class="input-group">
          <h3>ì¡°íšŒ ê¸°ê°„ ì„¤ì •</h3>
          <div class="form-row">
            <label for="monthYearSelect">ë…„ë„ & ì›”:</label>
            <select id="monthYearSelect" onchange="updateDateRange()">
              <option value="2025-01">2025ë…„ 1ì›”</option>
              <option value="2025-02">2025ë…„ 2ì›”</option>
              <option value="2025-03">2025ë…„ 3ì›”</option>
              <option value="2025-04">2025ë…„ 4ì›”</option>
              <option value="2025-05">2025ë…„ 5ì›”</option>
              <option value="2025-06">2025ë…„ 6ì›”</option>
              <option value="2025-07">2025ë…„ 7ì›”</option>
              <option value="2025-08">2025ë…„ 8ì›”</option>
              <option value="2025-09">2025ë…„ 9ì›”</option>
              <option value="2025-10">2025ë…„ 10ì›”</option>
              <option value="2025-11">2025ë…„ 11ì›”</option>
              <option value="2025-12">2025ë…„ 12ì›”</option>
            </select>
            <span id="selectedDateRange" style="margin-left: 15px; color: #666; font-size: 14px;">
              ì„ íƒëœ ê¸°ê°„: 2025ë…„ 9ì›” 1ì¼ ~ 2025ë…„ 9ì›” 30ì¼
            </span>
          </div>
        </div>

        <!-- Aì—´ ê°’ (valueA) ì„¤ì • ì„¹ì…˜ -->
        <div class="input-group">
          <h3>ë‹¨ì¼ & ë‹¤ì¤‘ ëª¨ë“œ ì„ íƒ</h3>
          
          <!-- ë‹¨ì¼ ê°’ ì…ë ¥ -->
          <div class="single-input">
            <label for="valueAInput">ë‹¨ì¼ ëª¨ë“œ(Group Number) :</label>
            <input type="number" id="valueAInput" placeholder="ì˜ˆ: 3" value="3" min="1" max="99" style="width: 100px;">
            <button id="executeWithValueABtn" onclick="executeWithValueA()" class="action-btn process-btn" disabled>
              <span class="btn-icon">ğŸ¯</span> ë‹¨ì¼ ëª¨ë“œ RPA ì‹¤í–‰
            </button>
          </div>
          
          <!-- ë‹¤ì¤‘ ê°’ ì…ë ¥ --> 
          <div class="single-input" style="margin-top: 15px;">
            <label for="multipleValueAInput">ë‹¤ì¤‘ ëª¨ë“œ(Group Number) :</label>
            <input type="text" id="multipleValueAInput" placeholder="ì˜ˆ: 1,2,3,5 ë˜ëŠ” 1~5" style="width: 200px;">
            <button id="executeMultipleValueABtn" onclick="executeMultipleValueA()" class="action-btn process-btn" disabled>
              <span class="btn-icon">ğŸ”„</span> ë‹¤ì¤‘ ëª¨ë“œ RPA ì‹¤í–‰
            </button>
          </div>
          
          <!-- ì‚¬ìš© ê°€ì´ë“œ -->
          <div style="margin-top: 10px; font-size: 12px; color: #666;">
            ğŸ’¡ <strong>ì‚¬ìš© ê°€ì´ë“œ:</strong> ë‹¨ì¼ ê°’ì€ í•˜ë‚˜ì˜ Aì—´ ê°’ë§Œ, ë‹¤ì¤‘ ê°’ì€ ì‰¼í‘œ(1,2,3) ë˜ëŠ” ë²”ìœ„(1~3) í˜•ì‹ìœ¼ë¡œ ì…ë ¥
          </div>
        </div>
        
      </div>


      <!-- ê²°ê³¼ í™•ì¸ -->
      <div class="section">
        <h3>ğŸ“Š ì²˜ë¦¬ ê²°ê³¼</h3>
        <div class="input-group">
          <h3>ì²˜ë¦¬ í†µê³„</h3>
          <div class="form-row">
            <label>ì´ ì²˜ë¦¬ ì‘ì—…:</label>
            <span id="totalFiles">0</span>
          </div>
          <div class="form-row">
            <label>ì²˜ë¦¬ ì™„ë£Œ:</label>
            <span id="completedFiles">0</span>
          </div>
          <div class="form-row">
            <label>ì²˜ë¦¬ ì‹¤íŒ¨:</label>
            <span id="failedFiles">0</span>
          </div>
          <div class="form-row">
            <label>ì„±ê³µë¥ :</label>
            <span id="successRate">0%</span>
          </div>
        </div>

        <!-- ë‹¨ê³„ë³„ ì²˜ë¦¬ ìƒì„¸ (ë‹¨ì¼ëª¨ë“œ) -->
        <div class="input-group" id="stepDetailsGroup" style="display: none;">
          <h3>ë‹¨ê³„ë³„ ì²˜ë¦¬ ìƒì„¸ (ë‹¨ì¼ëª¨ë“œ)</h3>
          <div id="stepDetails">
            <div class="step-item" id="step1">
              <span class="step-number">1ë‹¨ê³„:</span>
              <span class="step-name">ERP ì ‘ì† ë° ë¡œê·¸ì¸</span>
              <span class="step-status" id="step1Status">â³ ëŒ€ê¸°ì¤‘</span>
            </div>
            <div class="step-item" id="step2">
              <span class="step-number">2ë‹¨ê³„:</span>
              <span class="step-name">êµ¬ë§¤ ì…ê³ ë‚´ì—­ ì¡°íšŒ</span>
              <span class="step-status" id="step2Status">â³ ëŒ€ê¸°ì¤‘</span>
            </div>
            <div class="step-item" id="step3">
              <span class="step-number">3ë‹¨ê³„:</span>
              <span class="step-name">ì—‘ì…€ íŒŒì¼ ì—´ê¸° ë° ë§¤í¬ë¡œ ì‹¤í–‰</span>
              <span class="step-status" id="step3Status">â³ ëŒ€ê¸°ì¤‘</span>
            </div>
            <div class="step-item" id="step4">
              <span class="step-number">4ë‹¨ê³„:</span>
              <span class="step-name">ê¸°ì´ˆì›ê°€ê³µê¸‰ì‚¬ ë©”ë‰´ ì´ë™</span>
              <span class="step-status" id="step4Status">â³ ëŒ€ê¸°ì¤‘</span>
            </div>
            <div class="step-item" id="step5">
              <span class="step-number">5ë‹¨ê³„:</span>
              <span class="step-name">ìº˜ë¦°ë” ë²„íŠ¼ í´ë¦­ ë° ì†¡ì¥ ì²˜ë¦¬</span>
              <span class="step-status" id="step5Status">â³ ëŒ€ê¸°ì¤‘</span>
            </div>
            <div class="step-item" id="step6">
              <span class="step-number">6ë‹¨ê³„:</span>
              <span class="step-name">ëŒ€ê¸°ì¤‘ì¸ ê³µê¸‰ì‚¬ì†¡ì¥ ë©”ë‰´ ì´ë™</span>
              <span class="step-status" id="step6Status">â³ ëŒ€ê¸°ì¤‘</span>
            </div>
            <div class="step-item" id="step7">
              <span class="step-number">7ë‹¨ê³„:</span>
              <span class="step-name">ê·¸ë£¹ì›¨ì–´ ìƒì‹ </span>
              <span class="step-status" id="step7Status">â³ ëŒ€ê¸°ì¤‘</span>
            </div>
          </div>
        </div>

        <!-- ë‹¤ì¤‘ëª¨ë“œ ì²˜ë¦¬ ê²°ê³¼ -->
        <div class="input-group" id="multipleResultsGroup" style="display: none;">
          <h3>ë‹¤ì¤‘ëª¨ë“œ ì²˜ë¦¬ ê²°ê³¼</h3>
          <div id="multipleResults"></div>
        </div>

      </div>
    </div>
  </div>

  <script>
    // í˜„ì¬ ë‚ ì§œ ê°€ì ¸ì˜¤ê¸°
    const now = new Date();
    const currentYear = now.getFullYear();
    const currentMonth = now.getMonth() + 1; // 0-basedì´ë¯€ë¡œ +1

    // ê¸€ë¡œë²Œ ë³€ìˆ˜: ì„ íƒëœ ë…„ì›” ì •ë³´ (ë™ì  í˜„ì¬ì›”ë¡œ ì´ˆê¸°í™”)
    let selectedYearMonth = {
      year: currentYear,
      month: currentMonth,
      fromDate: null,
      toDate: null
    };

    // ë…„ë„&ì›” ì„ íƒ ì‹œ í˜¸ì¶œë˜ëŠ” í•¨ìˆ˜
    function updateDateRange() {
      const selectElement = document.getElementById('monthYearSelect');
      const selectedValue = selectElement.value; // ì˜ˆ: "2025-09"

      if (!selectedValue) return;

      const [year, month] = selectedValue.split('-');
      const yearNum = parseInt(year);
      const monthNum = parseInt(month);

      // ê¸€ë¡œë²Œ ë³€ìˆ˜ ì—…ë°ì´íŠ¸
      selectedYearMonth.year = yearNum;
      selectedYearMonth.month = monthNum;

      // í•´ë‹¹ ì›”ì˜ ì²«ë‚ ê³¼ ë§ˆì§€ë§‰ë‚  ê³„ì‚°
      const firstDay = new Date(yearNum, monthNum - 1, 1);
      const lastDay = new Date(yearNum, monthNum, 0);

      // FromDate, ToDate í˜•ì‹ìœ¼ë¡œ ì €ì¥ (M/d/YYYY)
      selectedYearMonth.fromDate = `${monthNum}/1/${yearNum}`;
      selectedYearMonth.toDate = `${monthNum}/${lastDay.getDate()}/${yearNum}`;

      // í™”ë©´ í‘œì‹œ í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
      const dateRangeSpan = document.getElementById('selectedDateRange');
      if (dateRangeSpan) {
        const monthNames = ['1ì›”', '2ì›”', '3ì›”', '4ì›”', '5ì›”', '6ì›”',
                           '7ì›”', '8ì›”', '9ì›”', '10ì›”', '11ì›”', '12ì›”'];
        const monthName = monthNames[monthNum - 1];
        dateRangeSpan.textContent = `ì„ íƒëœ ê¸°ê°„: ${yearNum}ë…„ ${monthName} 1ì¼ ~ ${yearNum}ë…„ ${monthName} ${lastDay.getDate()}ì¼`;
      }

      console.log('ì„ íƒëœ ê¸°ê°„ ì—…ë°ì´íŠ¸:', {
        year: yearNum,
        month: monthNum,
        fromDate: selectedYearMonth.fromDate,
        toDate: selectedYearMonth.toDate
      });

      // ë°±ì—”ë“œì— ì„ íƒëœ ë‚ ì§œ ì •ë³´ ì „ë‹¬ (Electron APIê°€ ìˆëŠ” ê²½ìš°)
      if (window.electronAPI && window.electronAPI.setSelectedDateRange) {
        window.electronAPI.setSelectedDateRange({
          year: yearNum,
          month: monthNum,
          fromDate: selectedYearMonth.fromDate,
          toDate: selectedYearMonth.toDate
        });
      }
    }

    // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸° ë‚ ì§œ ë²”ìœ„ ì„¤ì •
    function initializeDateRange() {
      // í˜„ì¬ì›”ì„ ì½¤ë³´ë°•ìŠ¤ì—ì„œ ì„ íƒ
      const selectElement = document.getElementById('monthYearSelect');
      const currentValue = `${currentYear}-${currentMonth.toString().padStart(2, '0')}`;

      // í˜„ì¬ì›”ì— í•´ë‹¹í•˜ëŠ” optionì„ selectedë¡œ ì„¤ì •
      if (selectElement) {
        const targetOption = selectElement.querySelector(`option[value="${currentValue}"]`);
        if (targetOption) {
          // ëª¨ë“  ì˜µì…˜ì˜ selected ì†ì„± ì œê±°
          Array.from(selectElement.options).forEach(option => option.selected = false);
          // í˜„ì¬ì›” ì˜µì…˜ë§Œ selected
          targetOption.selected = true;
          console.log(`ë™ì ìœ¼ë¡œ í˜„ì¬ì›” ì„ íƒë¨: ${currentValue} (${currentYear}ë…„ ${currentMonth}ì›”)`);
        } else {
          console.warn(`í˜„ì¬ì›” ì˜µì…˜ì„ ì°¾ì„ ìˆ˜ ì—†ìŒ: ${currentValue}`);
        }
      }

      updateDateRange();
    }

    // íŒŒì¼ ê´€ë¦¬
    // ì „ì²´ í˜ì´ì§€ ìŠ¤í¬ë¦° ìº¡ì²˜ í•¨ìˆ˜
    async function captureFullPage() {
      const captureBtn = document.querySelector('.screen-capture-btn');
      const captureIcon = document.getElementById('captureIcon');
      
      // ë²„íŠ¼ ìƒíƒœ ë³€ê²½
      const originalIcon = captureIcon.textContent;
      captureIcon.textContent = 'â³';
      captureBtn.disabled = true;
      captureBtn.style.opacity = '0.7';
      
      try {
        console.log('ì „ì²´ í˜ì´ì§€ ìŠ¤í¬ë¦° ìº¡ì²˜ ì‹œì‘');
        
        if (window.electronAPI && window.electronAPI.captureFullPage) {
          // Electron í™˜ê²½ì—ì„œ ì‹¤í–‰
          const result = await window.electronAPI.captureFullPage();
          
          if (result.success) {
            // ì„±ê³µ ì‹œ ì ê¹ ì²´í¬ ì•„ì´ì½˜ í‘œì‹œ
            captureIcon.textContent = 'âœ…';
            
            // ìƒì„¸í•œ ì„±ê³µ ë©”ì‹œì§€ í‘œì‹œ
            const message = result.message || 'ì „ì²´ í˜ì´ì§€ ìŠ¤í¬ë¦°ìƒ·ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!';
            const dimensions = result.dimensions;
            let detailMsg = `${message}\n\nê²½ë¡œ: ${result.path}`;
            
            if (dimensions) {
              detailMsg += `\ní¬ê¸°: ${dimensions.width}x${dimensions.height}px`;
              if (dimensions.steps) {
                detailMsg += `\nìº¡ì²˜ ë‹¨ê³„: ${dimensions.steps}ë‹¨ê³„`;
              }
              if (dimensions.scalingFactor) {
                detailMsg += `\nìŠ¤ì¼€ì¼ë§: ${dimensions.scalingFactor.toFixed(2)}x`;
              }
            }
            
            alert(detailMsg);
            
            setTimeout(() => {
              captureIcon.textContent = originalIcon;
            }, 2000);
          } else {
            captureIcon.textContent = 'âŒ';
            alert('ìŠ¤í¬ë¦°ìƒ· ì €ì¥ ì‹¤íŒ¨: ' + (result.error || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'));
            setTimeout(() => {
              captureIcon.textContent = originalIcon;
            }, 2000);
          }
        } else if (window.electron && window.electron.ipcRenderer) {
          // í˜¸í™˜ì„±ì„ ìœ„í•œ fallback
          const result = await window.electron.ipcRenderer.invoke('capture-full-page');
          
          if (result.success) {
            captureIcon.textContent = 'âœ…';
            const message = result.message || 'ì „ì²´ í˜ì´ì§€ ìŠ¤í¬ë¦°ìƒ·ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!';
            alert(`${message}\nê²½ë¡œ: ${result.path}`);
            setTimeout(() => {
              captureIcon.textContent = originalIcon;
            }, 2000);
          } else {
            captureIcon.textContent = 'âŒ';
            alert('ìŠ¤í¬ë¦°ìƒ· ì €ì¥ ì‹¤íŒ¨: ' + (result.error || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'));
            setTimeout(() => {
              captureIcon.textContent = originalIcon;
            }, 2000);
          }
        } else {
          // ë¸Œë¼ìš°ì € í™˜ê²½ì—ì„œëŠ” html2canvas ì‚¬ìš©
          await captureWithHtml2Canvas();
        }
        
      } catch (error) {
        console.error('ìŠ¤í¬ë¦° ìº¡ì²˜ ì˜¤ë¥˜:', error);
        captureIcon.textContent = 'âŒ';
        alert('ìŠ¤í¬ë¦° ìº¡ì²˜ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: ' + error.message);
        setTimeout(() => {
          captureIcon.textContent = originalIcon;
        }, 2000);
      } finally {
        // ë²„íŠ¼ ìƒíƒœ ë³µì›
        captureBtn.disabled = false;
        captureBtn.style.opacity = '1';
      }
    }// ë¸Œë¼ìš°ì € í™˜ê²½ì—ì„œ html2canvasë¥¼ ì‚¬ìš©í•œ ì „ì²´ í˜ì´ì§€ ìº¡ì²˜
    async function captureWithHtml2Canvas() {
      try {
        // html2canvas ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ë¡œë“œë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
        if (typeof html2canvas === 'undefined') {
          // html2canvas ë™ì  ë¡œë“œ
          const script = document.createElement('script');
          script.src = 'https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js';
          document.head.appendChild(script);
          
          await new Promise((resolve, reject) => {
            script.onload = resolve;
            script.onerror = reject;
          });
        }
        
        // í˜„ì¬ ìŠ¤í¬ë¡¤ ìœ„ì¹˜ ì €ì¥
        const originalScrollX = window.scrollX;
        const originalScrollY = window.scrollY;
        
        // í˜ì´ì§€ë¥¼ ë§¨ ìœ„ë¡œ ìŠ¤í¬ë¡¤
        window.scrollTo(0, 0);
        
        // ì „ì²´ í˜ì´ì§€ ìº¡ì²˜ (ìŠ¤í¬ë¡¤ ì˜ì—­ í¬í•¨)
        const canvas = await html2canvas(document.body, {
          height: document.body.scrollHeight,
          width: document.body.scrollWidth,
          useCORS: true,
          scale: 1,
          scrollX: 0,
          scrollY: 0,
          windowWidth: document.body.scrollWidth,
          windowHeight: document.body.scrollHeight
        });
        
        // ì›ë˜ ìŠ¤í¬ë¡¤ ìœ„ì¹˜ë¡œ ë³µì›
        window.scrollTo(originalScrollX, originalScrollY);
        
        // íŒŒì¼ëª… ìƒì„±
        const timestamp = new Date().toISOString().slice(0, 19).replace(/:/g, '-');
        const fileName = `screenshot_${timestamp}.png`;
        
        // ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ
        const link = document.createElement('a');
        link.download = fileName;
        link.href = canvas.toDataURL('image/png');
        link.click();
        
        // ì„±ê³µ ë©”ì‹œì§€
        const captureIcon = document.getElementById('captureIcon');
        captureIcon.textContent = 'âœ…';
        setTimeout(() => {
          captureIcon.textContent = 'ğŸ“·';
        }, 1500);
        
        alert(`ì „ì²´ í˜ì´ì§€ ìŠ¤í¬ë¦°ìƒ·ì´ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!\níŒŒì¼ëª…: ${fileName}\ní¬ê¸°: ${canvas.width}x${canvas.height}px`);
        
      } catch (error) {
        throw new Error('ë¸Œë¼ìš°ì € ì „ì²´ í˜ì´ì§€ ìº¡ì²˜ ì‹¤íŒ¨: ' + error.message);
      }
    }

    // ë‹¤í¬ëª¨ë“œ í† ê¸€ í•¨ìˆ˜
    function toggleDarkMode() {
      const body = document.body;
      const darkModeIcon = document.getElementById('darkModeIcon');
      
      body.classList.toggle('dark-mode');
      
      // ì•„ì´ì½˜ ë³€ê²½
      if (body.classList.contains('dark-mode')) {
        darkModeIcon.textContent = 'â˜€ï¸';
        localStorage.setItem('darkMode', 'enabled');
      } else {
        darkModeIcon.textContent = 'ğŸŒ™';
        localStorage.setItem('darkMode', 'disabled');
      }
    }

    // í˜ì´ì§€ ë¡œë“œ ì‹œ ë‹¤í¬ëª¨ë“œ ì„¤ì • ë³µì›
    function initializeDarkMode() {
      const darkMode = localStorage.getItem('darkMode');
      const body = document.body;
      const darkModeIcon = document.getElementById('darkModeIcon');
      
      if (darkMode === 'enabled') {
        body.classList.add('dark-mode');
        darkModeIcon.textContent = 'â˜€ï¸';
      } else {
        darkModeIcon.textContent = 'ğŸŒ™';
      }
    }

    // ê²°ê³¼ ë‹¤ìš´ë¡œë“œ
    function downloadResults() {
      // ë¡œê·¸ì¸ ìƒíƒœ í™•ì¸
      if (!isLoggedIn()) {
        alert('ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.');
        return;
      }
      alert('ê²°ê³¼ íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œí•©ë‹ˆë‹¤.');
    }

    // ê²°ê³¼ ë³´ê¸°
    function viewResults() {
      // ë¡œê·¸ì¸ ìƒíƒœ í™•ì¸
      if (!isLoggedIn()) {
        alert('ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.');
        return;
      }
      alert('ì²˜ë¦¬ ê²°ê³¼ë¥¼ í™•ì¸í•©ë‹ˆë‹¤.');
    }

    // ë³´ê³ ì„œ ë‚´ë³´ë‚´ê¸°
    function exportReport() {
      // ë¡œê·¸ì¸ ìƒíƒœ í™•ì¸
      if (!isLoggedIn()) {
        alert('ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.');
        return;
      }
      alert('ì²˜ë¦¬ ë³´ê³ ì„œë¥¼ ë‚´ë³´ëƒ…ë‹ˆë‹¤.');
    }    // ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸ í•¨ìˆ˜ (ë¡œê·¸ì¸ ìƒíƒœì— ë”°ë¼)
    function updateButtonStates() {
      const buttons = document.querySelectorAll('.btn-primary, .btn-success, .btn-secondary, .process-btn');
      const isUserLoggedIn = isLoggedIn();
      
      console.log('updateButtonStates í˜¸ì¶œë¨. ë¡œê·¸ì¸ ìƒíƒœ:', isUserLoggedIn);
      
      // Aì—´ ê°’ìœ¼ë¡œ RPA ì‹¤í–‰ ë²„íŠ¼ íŠ¹ë³„ ì²˜ë¦¬
      const executeWithValueABtn = document.getElementById('executeWithValueABtn');
      if (executeWithValueABtn) {
        console.log('executeWithValueABtn ìƒíƒœ ì—…ë°ì´íŠ¸:', isUserLoggedIn);
        executeWithValueABtn.disabled = !isUserLoggedIn;
        if (!isUserLoggedIn) {
          executeWithValueABtn.style.opacity = '0.5';
          executeWithValueABtn.title = 'ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤';
        } else {
          executeWithValueABtn.style.opacity = '1';
          executeWithValueABtn.title = '';
        }
      }
      
      // ë‹¤ì¤‘ Aì—´ ê°’ìœ¼ë¡œ RPA ì‹¤í–‰ ë²„íŠ¼ íŠ¹ë³„ ì²˜ë¦¬
      const executeMultipleValueABtn = document.getElementById('executeMultipleValueABtn');
      if (executeMultipleValueABtn) {
        console.log('executeMultipleValueABtn ìƒíƒœ ì—…ë°ì´íŠ¸:', isUserLoggedIn);
        executeMultipleValueABtn.disabled = !isUserLoggedIn;
        if (!isUserLoggedIn) {
          executeMultipleValueABtn.style.opacity = '0.5';
          executeMultipleValueABtn.title = 'ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤';
        } else {
          executeMultipleValueABtn.style.opacity = '1';
          executeMultipleValueABtn.title = '';
        }
      }
      
      // ì§„í–‰ ë²„íŠ¼ íŠ¹ë³„ ì²˜ë¦¬
      const processInvoiceBtn = document.getElementById('processInvoiceBtn');
      if (processInvoiceBtn) {
        console.log('processInvoiceBtn ìƒíƒœ ì—…ë°ì´íŠ¸:', isUserLoggedIn);
        processInvoiceBtn.disabled = !isUserLoggedIn;
        if (!isUserLoggedIn) {
          processInvoiceBtn.style.opacity = '0.5';
          processInvoiceBtn.title = 'ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤';
        } else {
          processInvoiceBtn.style.opacity = '1';
          processInvoiceBtn.title = '';
        }
      }
      
      // ë‹¤ë¥¸ ë²„íŠ¼ë“¤ ì²˜ë¦¬
      buttons.forEach(button => {
        if (button.id !== 'processInvoiceBtn' && button.id !== 'executeWithValueABtn' && button.id !== 'executeMultipleValueABtn') { // ì´ë¯¸ ì²˜ë¦¬ëœ ë²„íŠ¼ë“¤ ì œì™¸
          const shouldUpdate = (
            (button.onclick && (
              button.onclick.toString().includes('uploadFiles') ||
              button.onclick.toString().includes('startProcessing') ||
              button.onclick.toString().includes('downloadResults') ||
              button.onclick.toString().includes('viewResults') ||
              button.onclick.toString().includes('exportReport') ||
              button.onclick.toString().includes('executeRPA')
            ))
          );
          
          if (shouldUpdate) {
            console.log('ë²„íŠ¼ ì—…ë°ì´íŠ¸:', button.id || button.className, 'ë¡œê·¸ì¸ ìƒíƒœ:', isUserLoggedIn);
            button.disabled = !isUserLoggedIn;
            if (!isUserLoggedIn) {
              button.style.opacity = '0.5';
              button.title = 'ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤';
            } else {
              button.style.opacity = '1';
              button.title = '';
            }
          }
        }
      });    }    // RPA ì‹¤í–‰ í•¨ìˆ˜
    async function executeRPA() {
      console.log('=== RPA ì‹¤í–‰ ì‹œì‘ ===');
      console.log('executeRPA í•¨ìˆ˜ê°€ í˜¸ì¶œë˜ì—ˆìŠµë‹ˆë‹¤!');
      
      // ë¡œê·¸ì¸ ìƒíƒœ í™•ì¸ (ì—¬ëŸ¬ ë°©ë²•ìœ¼ë¡œ ì‹œë„)
      let loginStatus = false;
      
      if (typeof window.isLoggedIn === 'function') {
        loginStatus = window.isLoggedIn();
        console.log('window.isLoggedIn():', loginStatus);
      } else if (typeof isLoggedIn === 'function') {
        loginStatus = isLoggedIn();
        console.log('isLoggedIn():', loginStatus);
      } else {
        console.error('isLoggedIn í•¨ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤!');
        alert('ë¡œê·¸ì¸ ì‹œìŠ¤í…œ ì˜¤ë¥˜: ë¡œê·¸ì¸ í•¨ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\ní˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•´ì£¼ì„¸ìš”.');
        return;
      }
      
      if (!loginStatus) {
        console.log('ë¡œê·¸ì¸ë˜ì§€ ì•ŠìŒ - ë¡œê·¸ì¸ ì˜¤ë²„ë ˆì´ í‘œì‹œ');
        
        if (typeof showNotification === 'function') {
          showNotification('ë¨¼ì € ë¡œê·¸ì¸ì„ í•´ì£¼ì„¸ìš”.', 'warning');
        } else {
          alert('ë¨¼ì € ë¡œê·¸ì¸ì„ í•´ì£¼ì„¸ìš”.');
        }
        
        if (typeof showLoginOverlay === 'function') {
          showLoginOverlay();
        } else if (typeof window.showLoginOverlay === 'function') {
          window.showLoginOverlay();
        } else {
          console.warn('showLoginOverlay í•¨ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
        }
        return;
      }

      // RPA ì‹¤í–‰ ë²„íŠ¼ ì°¾ê¸°
      const rpaBtn = document.querySelector('button[onclick="executeRPA()"]');
      const originalHTML = rpaBtn ? rpaBtn.innerHTML : '';
      
      try {
        // ì²˜ë¦¬ ê²°ê³¼ ì´ˆê¸°í™”
        resetProcessingResults();
        
        // ë²„íŠ¼ ìƒíƒœ ë³€ê²½
        if (rpaBtn) {
          console.log('ë²„íŠ¼ ìƒíƒœ ë³€ê²½ ì¤‘...');
          rpaBtn.disabled = true;
          rpaBtn.innerHTML = '<span class="btn-icon">â³</span> ì²˜ë¦¬ ì¤‘...';
        }
        
        console.log('ë§¤ì…ì†¡ì¥ RPA ì²˜ë¦¬ ì‹œì‘...');
        
        if (typeof showNotification === 'function') {
          showNotification('ë§¤ì…ì†¡ì¥ RPA ì²˜ë¦¬ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤...', 'info');
        } else {
          alert('ë§¤ì…ì†¡ì¥ RPA ì²˜ë¦¬ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤...');
        }
        
        // API í™•ì¸ ë° í˜¸ì¶œ
        console.log('window.electronAPI í™•ì¸:', !!window.electronAPI);
        console.log('processInvoice API í™•ì¸:', !!window.electronAPI?.processInvoice);
        
        if (window.electronAPI && window.electronAPI.processInvoice) {
          console.log('Electron API í˜¸ì¶œ ì¤‘...');
          const result = await window.electronAPI.processInvoice();
          console.log('RPA ì²˜ë¦¬ ê²°ê³¼:', result);
          
          if (result.success) {
            // ì„±ê³µ ì‹œ ì²˜ë¦¬ ê²°ê³¼ ì—…ë°ì´íŠ¸
            updateProcessingResults(true, result);
            
            const message = result.message || 'RPA ì²˜ë¦¬ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.';
            if (typeof showNotification === 'function') {
              showNotification(message, 'success');
            } else {
              alert('ì„±ê³µ: ' + message);
            }
          } else {
            // ì‹¤íŒ¨ ì‹œ ì²˜ë¦¬ ê²°ê³¼ ì—…ë°ì´íŠ¸
            updateProcessingResults(false, result);
            
            const error = result.error || 'RPA ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.';
            if (typeof showNotification === 'function') {
              showNotification(error, 'error');
            } else {
              alert('ì˜¤ë¥˜: ' + error);
            }
          }
        } else {
          const errorMsg = 'Electron APIê°€ ì—°ê²°ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.';
          console.error(errorMsg);
          if (typeof showNotification === 'function') {
            showNotification(errorMsg, 'error');
          } else {
            alert('ì˜¤ë¥˜: ' + errorMsg);
          }
        }
        
      } catch (error) {
        console.error('RPA ì‹¤í–‰ ì˜¤ë¥˜:', error);
        const errorMsg = 'RPA ì‹¤í–‰ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message;
        if (typeof showNotification === 'function') {
          showNotification(errorMsg, 'error');
        } else {
          alert(errorMsg);
        }
      } finally {
        // ë²„íŠ¼ ìƒíƒœ ë³µì›
        console.log('ë²„íŠ¼ ìƒíƒœ ë³µì› ì¤‘...');
        if (rpaBtn) {
          rpaBtn.disabled = false;
          rpaBtn.innerHTML = originalHTML || '<span class="btn-icon">ğŸš€</span> RPA ì‹¤í–‰';
        }
      }
    }      // í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ ì‹œ ì´ˆê¸°í™”
    document.addEventListener('DOMContentLoaded', function() {
      console.log('=== DOMContentLoaded ì´ë²¤íŠ¸ ë°œìƒ ===');
      console.log('ì‚¬ìš© ê°€ëŠ¥í•œ í•¨ìˆ˜ë“¤ í™•ì¸:');
      console.log('- window.isLoggedIn:', typeof window.isLoggedIn);
      console.log('- isLoggedIn:', typeof isLoggedIn);
      console.log('- showNotification:', typeof showNotification);
      console.log('- showLoginOverlay:', typeof showLoginOverlay);
      console.log('- window.electronAPI:', !!window.electronAPI);
      console.log('- window.electronAPI.processInvoice:', !!window.electronAPI?.processInvoice);
      console.log('DOMContentLoaded ì´ë²¤íŠ¸ ë°œìƒ');
      
      // ë¡œê·¸ì¸ ì‹œìŠ¤í…œ ì´ˆê¸°í™”
      initializeLoginSystem();

      initializeDarkMode();

      // ë‚ ì§œ ë²”ìœ„ ì´ˆê¸°í™”
      initializeDateRange();
        // ë²„íŠ¼ ìƒíƒœ ì´ˆê¸°í™”      updateButtonStates();
      
      // ë‹¤ì¤‘ëª¨ë“œ ì§„í–‰ ìƒí™© ì—…ë°ì´íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡
      if (window.electronAPI && window.electronAPI.onMultipleModeProgress) {
        window.electronAPI.onMultipleModeProgress((progressData) => {
          console.log('ë‹¤ì¤‘ëª¨ë“œ ì§„í–‰ ìƒí™© ì—…ë°ì´íŠ¸:', progressData);
          updateMultipleModeProgress(
            progressData.groupNumber,
            progressData.currentStep,
            progressData.completedSteps,
            progressData.error
          );
        });
      }
    });

    // ë‹¤ì¤‘ Aì—´ ê°’ìœ¼ë¡œ RPA ì‹¤í–‰ í•¨ìˆ˜
    async function executeMultipleValueA() {
      console.log('=== ë‹¤ì¤‘ Aì—´ ê°’ìœ¼ë¡œ RPA ì‹¤í–‰ ì‹œì‘ ===');
      
      // ë¡œê·¸ì¸ ìƒíƒœ í™•ì¸
      let loginStatus = false;
      
      if (typeof window.isLoggedIn === 'function') {
        loginStatus = window.isLoggedIn();
      } else if (typeof isLoggedIn === 'function') {
        loginStatus = isLoggedIn();
      } else {
        console.error('isLoggedIn í•¨ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤!');
        alert('ë¡œê·¸ì¸ ì‹œìŠ¤í…œ ì˜¤ë¥˜: ë¡œê·¸ì¸ í•¨ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\ní˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•´ì£¼ì„¸ìš”.');
        return;
      }
      
      if (!loginStatus) {
        console.log('ë¡œê·¸ì¸ë˜ì§€ ì•ŠìŒ - ë¡œê·¸ì¸ ì˜¤ë²„ë ˆì´ í‘œì‹œ');
        if (typeof showNotification === 'function') {
          showNotification('ë¨¼ì € ë¡œê·¸ì¸ì„ í•´ì£¼ì„¸ìš”.', 'warning');
        } else {
          alert('ë¨¼ì € ë¡œê·¸ì¸ì„ í•´ì£¼ì„¸ìš”.');
        }
        
        if (typeof showLoginOverlay === 'function') {
          showLoginOverlay();
        } else if (typeof window.showLoginOverlay === 'function') {
          window.showLoginOverlay();
        }
        return;
      }

      // ë‹¤ì¤‘ Aì—´ ê°’ ì…ë ¥ ê²€ì¦
      const multipleValueAInput = document.getElementById('multipleValueAInput');
      const inputValue = multipleValueAInput.value.trim();
      
      if (!inputValue) {
        alert('ë‹¤ì¤‘ Aì—´ ê°’ì„ ì…ë ¥í•´ì£¼ì„¸ìš”\nì˜ˆì‹œ:\n- ì‰¼í‘œ í˜•ì‹: 1,2,3,5\n- ë²”ìœ„ í˜•ì‹: 1~5');
        multipleValueAInput.focus();
        return;
      }
      
      // ì…ë ¥ê°’ íŒŒì‹± (ì‰¼í‘œ ë˜ëŠ” í‹¸ë“œ ì§€ì›)
      let validatedValues = [];
      
      try {
        validatedValues = parseMultipleInput(inputValue);
      } catch (error) {
        alert(error.message);
        multipleValueAInput.focus();
        return;
      }
      
      if (validatedValues.length === 0) {
        alert('ìœ íš¨í•œ Aì—´ ê°’ì´ ì—†ìŠµë‹ˆë‹¤.');
        multipleValueAInput.focus();
        return;
      }
      
      console.log('ê²€ì¦ëœ Aì—´ ê°’ë“¤:', validatedValues);
      
      // í™•ì¸ ëŒ€í™”ìƒì
      const confirmMessage = `ë‹¤ìŒ ${validatedValues.length}ê°œì˜ Aì—´ ê°’ì„ ìˆœì°¨ì ìœ¼ë¡œ ì²˜ë¦¬í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\nê°’: ${validatedValues.join(', ')}\n\nì˜ˆìƒ ì†Œìš” ì‹œê°„: ì•½ ${validatedValues.length * 3}ë¶„`;
      if (!confirm(confirmMessage)) {
        return;
      }
      
      const executeBtn = document.getElementById('executeMultipleValueABtn');
      const originalHTML = executeBtn ? executeBtn.innerHTML : '';
      
      try {
        // ì²˜ë¦¬ ê²°ê³¼ ì´ˆê¸°í™”
        resetProcessingResults();
        
        // ë²„íŠ¼ ìƒíƒœ ë³€ê²½
        if (executeBtn) {
          executeBtn.disabled = true;
          executeBtn.innerHTML = '<span class="btn-icon">â³</span> ë‹¤ì¤‘ ì²˜ë¦¬ ì¤‘...';
        }
        
        console.log(`ë‹¤ì¤‘ Aì—´ ê°’ìœ¼ë¡œ ë§¤ì…ì†¡ì¥ RPA ì²˜ë¦¬ ì‹œì‘: ${validatedValues.join(', ')}`);
        
        if (typeof showNotification === 'function') {
          showNotification(`${validatedValues.length}ê°œ Aì—´ ê°’ ë‹¤ì¤‘ ì²˜ë¦¬ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤...`, 'info');
        } else {
          alert(`${validatedValues.length}ê°œ Aì—´ ê°’ ë‹¤ì¤‘ ì²˜ë¦¬ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤...`);
        }
        
        // API í™•ì¸ ë° í˜¸ì¶œ
        if (window.electronAPI && window.electronAPI.processMultipleValueA) {
          console.log('ë‹¤ì¤‘ Aì—´ ê°’ìœ¼ë¡œ Electron API í˜¸ì¶œ ì¤‘...');
          const result = await window.electronAPI.processMultipleValueA(validatedValues);
          console.log('ë‹¤ì¤‘ Aì—´ ê°’ RPA ì²˜ë¦¬ ê²°ê³¼:', result);
          
          if (result.success) {
            // ë‹¤ì¤‘ ì²˜ë¦¬ ì„±ê³µ ì‹œ - ë‹¨ì¼ ì™„ë£Œë¡œ í‘œì‹œ (ìµœì¢… ê²°ê³¼ë§Œ í‘œì‹œ)
            updateProcessingResults(true, result);
            
            const message = `ë‹¤ì¤‘ ì²˜ë¦¬ ì™„ë£Œ!\nì´ ${result.totalProcessed}ê°œ ì²˜ë¦¬ (ì„±ê³µ: ${result.successCount}, ì‹¤íŒ¨: ${result.failCount})`;
            if (typeof showNotification === 'function') {
              showNotification(message, 'success');
            } else {
              alert('ì„±ê³µ: ' + message);
            }
          } else {
            // ë‹¤ì¤‘ ì²˜ë¦¬ ì‹¤íŒ¨ ì‹œ
            updateProcessingResults(false, result);
            
            const error = result.error || 'ë‹¤ì¤‘ Aì—´ ê°’ RPA ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.';
            if (typeof showNotification === 'function') {
              showNotification(error, 'error');
            } else {
              alert('ì˜¤ë¥˜: ' + error);
            }
          }
        } else {
          const errorMsg = 'ë‹¤ì¤‘ Aì—´ ê°’ ì²˜ë¦¬ APIê°€ ì—°ê²°ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.';
          console.error(errorMsg);
          if (typeof showNotification === 'function') {
            showNotification(errorMsg, 'error');
          } else {
            alert('ì˜¤ë¥˜: ' + errorMsg);
          }
        }
        
      } catch (error) {
        console.error('ë‹¤ì¤‘ Aì—´ ê°’ RPA ì‹¤í–‰ ì˜¤ë¥˜:', error);
        const errorMsg = 'ë‹¤ì¤‘ Aì—´ ê°’ RPA ì‹¤í–‰ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message;
        if (typeof showNotification === 'function') {
          showNotification(errorMsg, 'error');
        } else {
          alert(errorMsg);
        }
      } finally {
        // ë²„íŠ¼ ìƒíƒœ ë³µì›
        if (executeBtn) {
          executeBtn.disabled = false;
          executeBtn.innerHTML = originalHTML || '<span class="btn-icon">ğŸ”„</span> ë‹¤ì¤‘ ê°’ RPA ì‹¤í–‰';
        }
      }
    }
    
    // Aì—´ ê°’ìœ¼ë¡œ RPA ì‹¤í–‰ í•¨ìˆ˜
    async function executeWithValueA() {
      console.log('=== Aì—´ ê°’ìœ¼ë¡œ RPA ì‹¤í–‰ ì‹œì‘ ===');
      
      // ë¡œê·¸ì¸ ìƒíƒœ í™•ì¸
      let loginStatus = false;
      
      if (typeof window.isLoggedIn === 'function') {
        loginStatus = window.isLoggedIn();
      } else if (typeof isLoggedIn === 'function') {
        loginStatus = isLoggedIn();
      } else {
        console.error('isLoggedIn í•¨ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤!');
        alert('ë¡œê·¸ì¸ ì‹œìŠ¤í…œ ì˜¤ë¥˜: ë¡œê·¸ì¸ í•¨ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\ní˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•´ì£¼ì„¸ìš”.');
        return;
      }
      
      if (!loginStatus) {
        console.log('ë¡œê·¸ì¸ë˜ì§€ ì•ŠìŒ - ë¡œê·¸ì¸ ì˜¤ë²„ë ˆì´ í‘œì‹œ');
        if (typeof showNotification === 'function') {
          showNotification('ë¨¼ì € ë¡œê·¸ì¸ì„ í•´ì£¼ì„¸ìš”.', 'warning');
        } else {
          alert('ë¨¼ì € ë¡œê·¸ì¸ì„ í•´ì£¼ì„¸ìš”.');
        }
        
        if (typeof showLoginOverlay === 'function') {
          showLoginOverlay();
        } else if (typeof window.showLoginOverlay === 'function') {
          window.showLoginOverlay();
        }
        return;
      }

      // Aì—´ ê°’ ì…ë ¥ ê²€ì¦
      const valueAInput = document.getElementById('valueAInput');
      const valueA = parseInt(valueAInput.value);
      
      if (isNaN(valueA) || valueA < 1 || valueA > 99) {
        alert('ì˜¬ë°”ë¥¸ Aì—´ ê°’ì„ ì…ë ¥í•´ì£¼ì„¸ìš” (1-99 ì‚¬ì´ì˜ ìˆ«ì)');
        valueAInput.focus();
        return;
      }
      
      console.log('ì…ë ¥ëœ Aì—´ ê°’:', valueA);
      
      const executeBtn = document.getElementById('executeWithValueABtn');
      const originalHTML = executeBtn ? executeBtn.innerHTML : '';
      
      try {
        // ì²˜ë¦¬ ê²°ê³¼ ì´ˆê¸°í™”
        resetProcessingResults();
        
        // ë²„íŠ¼ ìƒíƒœ ë³€ê²½
        if (executeBtn) {
          executeBtn.disabled = true;
          executeBtn.innerHTML = '<span class="btn-icon">â³</span> ì²˜ë¦¬ ì¤‘...';
        }
        
        console.log('Aì—´ ê°’ìœ¼ë¡œ ë§¤ì…ì†¡ì¥ RPA ì²˜ë¦¬ ì‹œì‘...');
        
        if (typeof showNotification === 'function') {
          showNotification(`Aì—´ ê°’ ${valueA}ë¡œ ë§¤ì…ì†¡ì¥ RPA ì²˜ë¦¬ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤...`, 'info');
        } else {
          alert(`Aì—´ ê°’ ${valueA}ë¡œ ë§¤ì…ì†¡ì¥ RPA ì²˜ë¦¬ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤...`);
        }
        
        // API í™•ì¸ ë° í˜¸ì¶œ (Aì—´ ê°’ ì„¤ì • í›„ ê¸°ì¡´ API ì‚¬ìš©)
        if (window.electronAPI && window.electronAPI.processInvoice) {
          console.log('Aì—´ ê°’ ì„¤ì • í›„ Electron API í˜¸ì¶œ ì¤‘...');
          
          // ë¨¼ì € Aì—´ ê°’ì„ ì„¤ì •
          if (window.electronAPI.setValueA) {
            console.log(`[UI] Aì—´ ê°’ ${valueA} ì„¤ì • API í˜¸ì¶œ ì¤‘...`);
            const setResult = await window.electronAPI.setValueA(valueA);
            console.log(`[UI] Aì—´ ê°’ ì„¤ì • ê²°ê³¼:`, setResult);
            
            if (!setResult.success) {
              throw new Error(`Aì—´ ê°’ ì„¤ì • ì‹¤íŒ¨: ${setResult.error}`);
            }
          } else {
            console.error('[UI] window.electronAPI.setValueA í•¨ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ');
          }
          
          // ê¸°ì¡´ processInvoice API í˜¸ì¶œ
          const result = await window.electronAPI.processInvoice();
          console.log('Aì—´ ê°’ RPA ì²˜ë¦¬ ê²°ê³¼:', result);
          
          if (result.success) {
            // ì„±ê³µ ì‹œ ì²˜ë¦¬ ê²°ê³¼ ì—…ë°ì´íŠ¸
            updateProcessingResults(true, result);
            
            const message = result.message || `Aì—´ ê°’ ${valueA}ë¡œ RPA ì²˜ë¦¬ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.`;
            if (typeof showNotification === 'function') {
              showNotification(message, 'success');
            } else {
              alert('ì„±ê³µ: ' + message);
            }
          } else {
            // ì‹¤íŒ¨ ì‹œ ì²˜ë¦¬ ê²°ê³¼ ì—…ë°ì´íŠ¸
            updateProcessingResults(false, result);
            
            const error = result.error || 'Aì—´ ê°’ RPA ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.';
            if (typeof showNotification === 'function') {
              showNotification(error, 'error');
            } else {
              alert('ì˜¤ë¥˜: ' + error);
            }
          }
        } else {
          const errorMsg = 'RPA ì²˜ë¦¬ APIê°€ ì—°ê²°ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.';
          console.error(errorMsg);
          if (typeof showNotification === 'function') {
            showNotification(errorMsg, 'error');
          } else {
            alert('ì˜¤ë¥˜: ' + errorMsg);
          }
        }
        
      } catch (error) {
        console.error('Aì—´ ê°’ RPA ì‹¤í–‰ ì˜¤ë¥˜:', error);
        const errorMsg = 'Aì—´ ê°’ RPA ì‹¤í–‰ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message;
        if (typeof showNotification === 'function') {
          showNotification(errorMsg, 'error');
        } else {
          alert(errorMsg);
        }
      } finally {
        // ë²„íŠ¼ ìƒíƒœ ë³µì›
        if (executeBtn) {
          executeBtn.disabled = false;
          executeBtn.innerHTML = originalHTML || '<span class="btn-icon">ğŸ¯</span> Aì—´ ê°’ìœ¼ë¡œ RPA ì‹¤í–‰';
        }
      }
    }
    
    // ì²˜ë¦¬ ê²°ê³¼ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
    function updateProcessingResults(success, result) {
      console.log('ì²˜ë¦¬ ê²°ê³¼ ì—…ë°ì´íŠ¸:', success, result);
      
      // ë‹¤ì¤‘ ëª¨ë“œì¸ì§€ í™•ì¸
      const isMultipleMode = result && result.isMultipleMode;
      
      if (isMultipleMode) {
        // ë‹¤ì¤‘ëª¨ë“œ ê²°ê³¼ í‘œì‹œ
        updateMultipleModeResults(result);
      } else {
        // ë‹¨ì¼ëª¨ë“œ ê²°ê³¼ í‘œì‹œ
        updateSingleModeResults(success, result);
      }
    }
    
    // ë‹¨ì¼ëª¨ë“œ ê²°ê³¼ ì—…ë°ì´íŠ¸
    function updateSingleModeResults(success, result) {
      // ë‹¨ì¼ëª¨ë“œ ë‹¨ê³„ë³„ ìƒì„¸ í‘œì‹œ
      const stepDetailsGroup = document.getElementById('stepDetailsGroup');
      if (stepDetailsGroup) {
        stepDetailsGroup.style.display = 'block';
      }
      
      // ë‹¤ì¤‘ëª¨ë“œ ê²°ê³¼ëŠ” ìˆ¨ê¸°ê¸°
      const multipleResultsGroup = document.getElementById('multipleResultsGroup');
      if (multipleResultsGroup) {
        multipleResultsGroup.style.display = 'none';
      }
      
      // í†µê³„ ì—…ë°ì´íŠ¸
      const totalFiles = document.getElementById('totalFiles');
      const completedFiles = document.getElementById('completedFiles');
      const failedFiles = document.getElementById('failedFiles');
      const successRate = document.getElementById('successRate');
      
      if (totalFiles) totalFiles.textContent = '1';
      
      if (success) {
        if (completedFiles) completedFiles.textContent = '1';
        if (failedFiles) failedFiles.textContent = '0';
        if (successRate) successRate.textContent = '100%';
        
        // ëª¨ë“  ë‹¨ê³„ë¥¼ ì™„ë£Œë¡œ í‘œì‹œ
        for (let i = 1; i <= 7; i++) {
          const stepStatus = document.getElementById(`step${i}Status`);
          if (stepStatus) {
            stepStatus.textContent = 'âœ… ì™„ë£Œ';
            stepStatus.className = 'step-status completed';
          }
        }
      } else {
        if (completedFiles) completedFiles.textContent = '0';
        if (failedFiles) failedFiles.textContent = '1';
        if (successRate) successRate.textContent = '0%';
        
        // ì‹¤íŒ¨í•œ ë‹¨ê³„ê¹Œì§€ë§Œ í‘œì‹œ (ê²°ê³¼ì—ì„œ ì‹¤íŒ¨ ë‹¨ê³„ ì •ë³´ê°€ ìˆìœ¼ë©´ í™œìš©)
        const failedStep = extractFailedStepFromResult(result);
        
        for (let i = 1; i <= 7; i++) {
          const stepStatus = document.getElementById(`step${i}Status`);
          if (stepStatus) {
            if (i < failedStep) {
              stepStatus.textContent = 'âœ… ì™„ë£Œ';
              stepStatus.className = 'step-status completed';
            } else if (i === failedStep) {
              stepStatus.textContent = 'âŒ ì‹¤íŒ¨';
              stepStatus.className = 'step-status failed';
            } else {
              stepStatus.textContent = 'â¸ï¸ ì¤‘ë‹¨';
              stepStatus.className = 'step-status waiting';
            }
          }
        }
      }
    }
    
    // ë‹¤ì¤‘ëª¨ë“œ ê²°ê³¼ ì—…ë°ì´íŠ¸
    function updateMultipleModeResults(result) {
      console.log('ë‹¤ì¤‘ëª¨ë“œ ê²°ê³¼ ì—…ë°ì´íŠ¸:', result);
      
      // ë‹¨ì¼ëª¨ë“œ ë‹¨ê³„ë³„ ìƒì„¸ëŠ” ìˆ¨ê¸°ê¸°
      const stepDetailsGroup = document.getElementById('stepDetailsGroup');
      if (stepDetailsGroup) {
        stepDetailsGroup.style.display = 'none';
      }
      
      // ë‹¤ì¤‘ëª¨ë“œ ê²°ê³¼ í‘œì‹œ
      const multipleResultsGroup = document.getElementById('multipleResultsGroup');
      if (multipleResultsGroup) {
        multipleResultsGroup.style.display = 'block';
      }
      
      const multipleResults = document.getElementById('multipleResults');
      if (multipleResults && result.groupResults) {
        multipleResults.innerHTML = '';
        
        // ê° ê·¸ë£¹ë³„ ê²°ê³¼ í‘œì‹œ
        result.groupResults.forEach(groupResult => {
          const groupDiv = createGroupResultElement(groupResult);
          multipleResults.appendChild(groupDiv);
        });
      }
      
      // ì „ì²´ í†µê³„ ì—…ë°ì´íŠ¸
      const totalFiles = document.getElementById('totalFiles');
      const completedFiles = document.getElementById('completedFiles');
      const failedFiles = document.getElementById('failedFiles');
      const successRate = document.getElementById('successRate');
      
      if (result.totalProcessed && totalFiles) {
        totalFiles.textContent = result.totalProcessed.toString();
      }
      if (result.successCount !== undefined && completedFiles) {
        completedFiles.textContent = result.successCount.toString();
      }
      if (result.failCount !== undefined && failedFiles) {
        failedFiles.textContent = result.failCount.toString();
      }
      if (result.totalProcessed && result.successCount !== undefined && successRate) {
        const rate = result.totalProcessed > 0 ? Math.round((result.successCount / result.totalProcessed) * 100) : 0;
        successRate.textContent = `${rate}%`;
      }
    }
    
    // ê·¸ë£¹ ê²°ê³¼ ì—˜ë¦¬ë¨¼íŠ¸ ìƒì„±
    function createGroupResultElement(groupResult) {
      const groupDiv = document.createElement('div');
      groupDiv.className = 'group-result';
      
      // í—¤ë” ìƒì„±
      const headerDiv = document.createElement('div');
      let headerClass = 'group-header';
      let statusText = 'ì²˜ë¦¬ ì¤‘';
      let statusIcon = 'â³';
      
      if (groupResult.success) {
        headerClass += ' success';
        statusText = 'ì™„ë£Œ';
        statusIcon = 'âœ…';
      } else if (groupResult.error) {
        headerClass += ' failed';
        statusText = 'ì‹¤íŒ¨';
        statusIcon = 'âŒ';
      } else if (groupResult.processing) {
        headerClass += ' processing';
        statusText = 'ì²˜ë¦¬ ì¤‘';
        statusIcon = 'â³';
      }
      
      headerDiv.className = headerClass;
      headerDiv.innerHTML = `
        <span>ê·¸ë£¹ë„˜ë²„ ${groupResult.groupNumber}</span>
        <span>${statusIcon} ${statusText}</span>
      `;
      
      // ë°”ë”” ìƒì„±
      const bodyDiv = document.createElement('div');
      bodyDiv.className = 'group-body';
      
      if (groupResult.error) {
        bodyDiv.innerHTML = `
          <div style="color: #e74c3c; font-weight: bold; margin-bottom: 10px;">
            ì˜¤ë¥˜: ${groupResult.error}
          </div>
        `;
      }
      
      // ë‹¨ê³„ë³„ ê²°ê³¼ ìƒì„±
      const stepsDiv = document.createElement('div');
      stepsDiv.className = 'group-steps';
      
      const stepNames = [
        'ERP ì ‘ì† ë° ë¡œê·¸ì¸',
        'êµ¬ë§¤ ì…ê³ ë‚´ì—­ ì¡°íšŒ', 
        'ì—‘ì…€ íŒŒì¼ ì—´ê¸° ë° ë§¤í¬ë¡œ ì‹¤í–‰',
        'ê¸°ì´ˆì›ê°€ê³µê¸‰ì‚¬ ë©”ë‰´ ì´ë™',
        'ìº˜ë¦°ë” ë²„íŠ¼ í´ë¦­ ë° ì†¡ì¥ ì²˜ë¦¬',
        'ëŒ€ê¸°ì¤‘ì¸ ê³µê¸‰ì‚¬ì†¡ì¥ ë©”ë‰´ ì´ë™',
        'ê·¸ë£¹ì›¨ì–´ ìƒì‹ '
      ];
      
      for (let i = 1; i <= 7; i++) {
        const stepDiv = document.createElement('div');
        stepDiv.className = 'group-step';
        
        let stepStatusClass = 'waiting';
        let stepStatusText = 'ëŒ€ê¸°';
        
        if (groupResult.completedSteps && groupResult.completedSteps >= i) {
          stepStatusClass = 'completed';
          stepStatusText = 'ì™„ë£Œ';
        } else if (groupResult.failedStep === i) {
          stepStatusClass = 'failed';
          stepStatusText = 'ì‹¤íŒ¨';
        } else if (groupResult.currentStep === i) {
          stepStatusClass = 'processing';
          stepStatusText = 'ì§„í–‰ì¤‘';
        }
        
        stepDiv.innerHTML = `
          <span class="group-step-number">${i}ë‹¨ê³„</span>
          <span class="group-step-name">${stepNames[i-1]}</span>
          <span class="group-step-status ${stepStatusClass}">${stepStatusText}</span>
        `;
        
        stepsDiv.appendChild(stepDiv);
      }
      
      bodyDiv.appendChild(stepsDiv);
      groupDiv.appendChild(headerDiv);
      groupDiv.appendChild(bodyDiv);
      
      return groupDiv;
    }
    
    // ê²°ê³¼ì—ì„œ ì‹¤íŒ¨í•œ ë‹¨ê³„ ì¶”ì¶œ (ì—ëŸ¬ ë©”ì‹œì§€ ë¶„ì„)
    function extractFailedStepFromResult(result) {
      const errorMessage = result?.error?.toLowerCase() || '';
      
      if (errorMessage.includes('ë¡œê·¸ì¸') || errorMessage.includes('ì ‘ì†')) {
        return 1; // 1ë‹¨ê³„ ì‹¤íŒ¨
      } else if (errorMessage.includes('êµ¬ë§¤') || errorMessage.includes('ì…ê³ ') || errorMessage.includes('ê²€ìƒ‰ë²„íŠ¼')) {
        return 2; // 2ë‹¨ê³„ ì‹¤íŒ¨
      } else if (errorMessage.includes('ì—‘ì…€') || errorMessage.includes('ë§¤í¬ë¡œ')) {
        return 3; // 3ë‹¨ê³„ ì‹¤íŒ¨
      } else if (errorMessage.includes('ê¸°ì´ˆì›ê°€') || errorMessage.includes('ê³µê¸‰ì‚¬')) {
        return 4; // 4ë‹¨ê³„ ì‹¤íŒ¨
      } else if (errorMessage.includes('ìº˜ë¦°ë”') || errorMessage.includes('ì†¡ì¥')) {
        return 5; // 5ë‹¨ê³„ ì‹¤íŒ¨
      } else if (errorMessage.includes('6ë²ˆ') || errorMessage.includes('ëŒ€ê¸°ì¤‘ì¸')) {
        return 6; // 6ë‹¨ê³„ ì‹¤íŒ¨
      } else if (errorMessage.includes('7ë²ˆ') || errorMessage.includes('ê·¸ë£¹ì›¨ì–´')) {
        return 7; // 7ë‹¨ê³„ ì‹¤íŒ¨
      }
      
      return 7; // ê¸°ë³¸ì ìœ¼ë¡œ ë§ˆì§€ë§‰ ë‹¨ê³„ì—ì„œ ì‹¤íŒ¨í•œ ê²ƒìœ¼ë¡œ ê°€ì •
    }
    
    // ì²˜ë¦¬ ê²°ê³¼ ì´ˆê¸°í™” í•¨ìˆ˜
    function resetProcessingResults() {
      console.log('ì²˜ë¦¬ ê²°ê³¼ ì´ˆê¸°í™”');
      
      // ë‹¨ì¼ëª¨ë“œ ê²°ê³¼ ì´ˆê¸°í™”
      const stepDetailsGroup = document.getElementById('stepDetailsGroup');
      if (stepDetailsGroup) {
        stepDetailsGroup.style.display = 'none';
      }
      
      // ë‹¤ì¤‘ëª¨ë“œ ê²°ê³¼ ì´ˆê¸°í™”
      const multipleResultsGroup = document.getElementById('multipleResultsGroup');
      if (multipleResultsGroup) {
        multipleResultsGroup.style.display = 'none';
      }
      
      const multipleResults = document.getElementById('multipleResults');
      if (multipleResults) {
        multipleResults.innerHTML = '';
      }
      
      // í†µê³„ ì´ˆê¸°í™”
      const totalFiles = document.getElementById('totalFiles');
      const completedFiles = document.getElementById('completedFiles');
      const failedFiles = document.getElementById('failedFiles');
      const successRate = document.getElementById('successRate');
      
      if (totalFiles) totalFiles.textContent = '0';
      if (completedFiles) completedFiles.textContent = '0';
      if (failedFiles) failedFiles.textContent = '0';
      if (successRate) successRate.textContent = '0%';
      
      // ë‹¨ì¼ëª¨ë“œ ëª¨ë“  ë‹¨ê³„ë¥¼ ëŒ€ê¸°ì¤‘ìœ¼ë¡œ ì´ˆê¸°í™”
      for (let i = 1; i <= 7; i++) {
        const stepStatus = document.getElementById(`step${i}Status`);
        if (stepStatus) {
          stepStatus.textContent = 'â³ ëŒ€ê¸°ì¤‘';
          stepStatus.className = 'step-status waiting';
        }
      }
    }
    
    // ë‹¤ì¤‘ëª¨ë“œ ì‹¤ì‹œê°„ ê²°ê³¼ ì—…ë°ì´íŠ¸ (ì§„í–‰ ì¤‘ ìƒíƒœ ì—…ë°ì´íŠ¸ìš©)
    function updateMultipleModeProgress(groupNumber, currentStep, completedSteps, error) {
      const multipleResults = document.getElementById('multipleResults');
      if (!multipleResults) return;
      
      const existingGroupDiv = multipleResults.querySelector(`[data-group="${groupNumber}"]`);
      
      const groupResult = {
        groupNumber: groupNumber,
        currentStep: currentStep,
        completedSteps: completedSteps,
        processing: !error && currentStep > 0,
        success: !error && completedSteps >= 7,
        error: error
      };
      
      if (error) {
        groupResult.failedStep = currentStep;
      }
      
      const newGroupDiv = createGroupResultElement(groupResult);
      newGroupDiv.setAttribute('data-group', groupNumber);
      
      if (existingGroupDiv) {
        multipleResults.replaceChild(newGroupDiv, existingGroupDiv);
      } else {
        multipleResults.appendChild(newGroupDiv);
        
        // ë‹¤ì¤‘ëª¨ë“œ ê²°ê³¼ í‘œì‹œ
        const multipleResultsGroup = document.getElementById('multipleResultsGroup');
        if (multipleResultsGroup) {
          multipleResultsGroup.style.display = 'block';
        }
      }
    }

    // ë‹¤ì¤‘ ì…ë ¥ê°’ íŒŒì‹± í•¨ìˆ˜ (ì‰¼í‘œ, í‹¸ë“œ ì§€ì›)
    function parseMultipleInput(inputValue) {
      const values = [];
      
      // í‹¸ë“œ(~) í˜•ì‹ ì²´í¬
      if (inputValue.includes('~')) {
        // í‹¸ë“œëŠ” í•˜ë‚˜ë§Œ í—ˆìš©
        if ((inputValue.match(/~/g) || []).length > 1) {
          throw new Error('í‹¸ë“œ(~)ëŠ” í•˜ë‚˜ì˜ ë²”ìœ„ì—ë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nì˜ˆ: 1~5');
        }
        
        // ì‰¼í‘œì™€ í‹¸ë“œ í˜¼ìš© ë¶ˆí—ˆ
        if (inputValue.includes(',')) {
          throw new Error('ì‰¼í‘œ(,)ì™€ í‹¸ë“œ(~)ë¥¼ ë™ì‹œì— ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\në‹¤ìŒ ì¤‘ í•˜ë‚˜ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”:\n- ì‰¼í‘œ í˜•ì‹: 1,2,3,5\n- ë²”ìœ„ í˜•ì‹: 1~5');
        }
        
        const parts = inputValue.split('~').map(v => v.trim());
        if (parts.length !== 2) {
          throw new Error('í‹¸ë“œ í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.\nì˜¬ë°”ë¥¸ ì˜ˆ: 1~5');
        }
        
        const start = parseInt(parts[0]);
        const end = parseInt(parts[1]);
        
        if (isNaN(start) || isNaN(end)) {
          throw new Error('ë²”ìœ„ ê°’ì´ ìˆ«ìê°€ ì•„ë‹™ë‹ˆë‹¤.\nì˜ˆ: 1~5');
        }
        
        if (start < 1 || start > 99 || end < 1 || end > 99) {
          throw new Error('ë²”ìœ„ ê°’ì€ 1-99 ì‚¬ì´ì—¬ì•¼ í•©ë‹ˆë‹¤.');
        }
        
        if (start > end) {
          throw new Error('ë²”ìœ„ê°€ ì—­ìˆœì…ë‹ˆë‹¤.\nìˆœì°¨ì ìœ¼ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”.\nì˜ˆ: 1~5 (5~1 âŒ)');
        }
        
        // ë²”ìœ„ ê°’ ìƒì„±
        for (let i = start; i <= end; i++) {
          values.push(i);
        }
        
      } else if (inputValue.includes(',')) {
        // ì‰¼í‘œ í˜•ì‹
        const parts = inputValue.split(',').map(v => v.trim()).filter(v => v !== '');
        
        for (const part of parts) {
          const numValue = parseInt(part);
          if (isNaN(numValue) || numValue < 1 || numValue > 99) {
            throw new Error(`ì˜ëª»ëœ Aì—´ ê°’: "${part}"\n1-99 ì‚¬ì´ì˜ ìˆ«ìë§Œ ì…ë ¥í•´ì£¼ì„¸ìš”.`);
          }
          if (!values.includes(numValue)) {
            values.push(numValue);
          }
        }
        
      } else {
        // ë‹¨ì¼ ê°’
        const numValue = parseInt(inputValue);
        if (isNaN(numValue) || numValue < 1 || numValue > 99) {
          throw new Error('ì˜¬ë°”ë¥¸ Aì—´ ê°’ì„ ì…ë ¥í•´ì£¼ì„¸ìš” (1-99 ì‚¬ì´ì˜ ìˆ«ì)');
        }
        values.push(numValue);
      }
      
      // ì¤‘ë³µ ì œê±° ë° ì •ë ¬
      return [...new Set(values)].sort((a, b) => a - b);
    }

    // ì „ì—­ì—ì„œ ì ‘ê·¼ ê°€ëŠ¥í•˜ë„ë¡ window ê°ì²´ì— í• ë‹¹
    window.captureFullPage = captureFullPage;
    window.toggleDarkMode = toggleDarkMode;
    window.executeWithValueA = executeWithValueA;
    window.executeMultipleValueA = executeMultipleValueA;
    window.updateProcessingResults = updateProcessingResults;
    window.updateSingleModeResults = updateSingleModeResults;
    window.updateMultipleModeResults = updateMultipleModeResults;
    window.updateMultipleModeProgress = updateMultipleModeProgress;
    window.resetProcessingResults = resetProcessingResults;
    window.createGroupResultElement = createGroupResultElement;
    window.parseMultipleInput = parseMultipleInput;
  </script>
</body>
</html>
